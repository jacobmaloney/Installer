<Window x:Class="InstallerRuntime.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:InstallerRuntime"
        mc:Ignorable="d"
        Title="Application Installer"
        Height="600" Width="900"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="MinWidth" Value="100"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="0,5"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="0,10,0,5"/>
        </Style>
        <Style TargetType="Label">
            <Setter Property="Margin" Value="0,10,0,2"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2196F3" Padding="20">
            <StackPanel>
                <TextBlock Text="Application Installer"
                          FontSize="24"
                          FontWeight="Bold"
                          Foreground="White"/>
                <TextBlock x:Name="TxtSubtitle"
                          Text="Install your application to IIS"
                          FontSize="14"
                          Foreground="White"
                          Opacity="0.9"/>
            </StackPanel>
        </Border>

        <!-- Wizard Content -->
        <TabControl x:Name="WizardTabs"
                   Grid.Row="1"
                   SelectionChanged="WizardTabs_SelectionChanged"
                   Padding="0"
                   BorderThickness="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Visibility" Value="Collapsed"/>
                </Style>
            </TabControl.Resources>

            <!-- Step 1: Welcome -->
            <TabItem x:Name="TabWelcome" Header="Welcome">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="40">
                        <TextBlock Text="Welcome"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Margin="0,0,0,20"/>

                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                            This wizard will guide you through installing your application on this server.
                        </TextBlock>

                        <TextBlock Text="Prerequisites:"
                                  FontWeight="Bold"
                                  Margin="0,20,0,10"/>

                        <Border Background="#F5F5F5"
                               Padding="15"
                               BorderBrush="#DDD"
                               BorderThickness="1">
                            <StackPanel x:Name="PrerequisitesPanel">
                                <TextBlock x:Name="TxtPrereqIIS" Text="• Checking IIS..." Margin="0,5"/>
                                <TextBlock x:Name="TxtPrereqDotNet" Text="• Checking .NET Runtime..." Margin="0,5"/>
                                <TextBlock x:Name="TxtPrereqAdmin" Text="• Checking Administrator privileges..." Margin="0,5"/>
                            </StackPanel>
                        </Border>

                        <TextBlock x:Name="TxtPrereqStatus"
                                  Text=""
                                  Margin="0,20,0,0"
                                  FontWeight="Bold"
                                  Foreground="Green"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Step 2: Installation Location -->
            <TabItem x:Name="TabLocation" Header="Installation Location" IsEnabled="False">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="40">
                        <TextBlock Text="Installation Location"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Margin="0,0,0,20"/>

                        <Label Content="Choose where to install the application files:"/>

                        <DockPanel Margin="0,5,0,20">
                            <Button x:Name="BtnBrowseLocation"
                                   Content="Browse..."
                                   DockPanel.Dock="Right"
                                   Click="BtnBrowseLocation_Click"/>
                            <TextBox x:Name="TxtInstallPath"
                                    IsReadOnly="True"/>
                        </DockPanel>

                        <TextBlock TextWrapping="Wrap"
                                  FontSize="12"
                                  Foreground="Gray"
                                  Margin="0,0,0,20">
                            The application files will be copied to this location. Make sure you have sufficient disk space.
                        </TextBlock>

                        <Label Content="Application Name:"/>
                        <TextBox x:Name="TxtApplicationName" Text="MyApplication"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Step 3: IIS Configuration -->
            <TabItem x:Name="TabIIS" Header="IIS Configuration" IsEnabled="False">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="40">
                        <TextBlock Text="IIS Configuration"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Margin="0,0,0,20"/>

                        <CheckBox x:Name="ChkCreateNewSite"
                                 Content="Create new IIS site"
                                 IsChecked="True"
                                 Checked="ChkCreateNewSite_CheckedChanged"
                                 Unchecked="ChkCreateNewSite_CheckedChanged"/>

                        <StackPanel x:Name="NewSitePanel">
                            <Label Content="Site Name:"/>
                            <TextBox x:Name="TxtSiteName" Text="MyApplication"/>

                            <Label Content="Port:"/>
                            <TextBox x:Name="TxtPort" Text="8080"/>

                            <Label Content="Host Name (optional):"/>
                            <TextBox x:Name="TxtHostName" Text=""/>

                            <Label Content="Application Pool Name:"/>
                            <TextBox x:Name="TxtAppPoolName" Text="MyApplicationAppPool"/>
                        </StackPanel>

                        <TextBlock x:Name="ExistingSitePanel"
                                  Visibility="Collapsed"
                                  TextWrapping="Wrap"
                                  Margin="0,10">
                            You can configure the site manually in IIS Manager after installation is complete.
                        </TextBlock>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Step 4: Installing -->
            <TabItem x:Name="TabInstalling" Header="Installing" IsEnabled="False">
                <Grid Margin="40">
                    <StackPanel>
                        <TextBlock Text="Installing"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Margin="0,0,0,20"/>

                        <TextBlock x:Name="TxtInstallStatus"
                                  Text="Preparing installation..."
                                  Margin="0,0,0,10"/>

                        <ProgressBar x:Name="ProgressBar"
                                    Height="25"
                                    IsIndeterminate="True"
                                    Margin="0,0,0,20"/>

                        <ScrollViewer Height="300"
                                     VerticalScrollBarVisibility="Auto"
                                     Margin="0,10">
                            <TextBox x:Name="TxtInstallLog"
                                    IsReadOnly="True"
                                    TextWrapping="Wrap"
                                    Background="#F5F5F5"
                                    BorderBrush="#DDD"
                                    FontFamily="Consolas"
                                    FontSize="11"
                                    VerticalScrollBarVisibility="Auto"/>
                        </ScrollViewer>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- Step 5: Complete -->
            <TabItem x:Name="TabComplete" Header="Complete" IsEnabled="False">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="40">
                        <TextBlock Text="✓ Installation Complete"
                                  FontSize="20"
                                  FontWeight="Bold"
                                  Foreground="Green"
                                  Margin="0,0,0,20"/>

                        <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                            Your application has been successfully installed and configured.
                        </TextBlock>

                        <Border Background="#E8F5E9"
                               Padding="15"
                               BorderBrush="#4CAF50"
                               BorderThickness="1"
                               Margin="0,20">
                            <StackPanel>
                                <TextBlock Text="Next Steps:" FontWeight="Bold" Margin="0,0,0,10"/>
                                <TextBlock x:Name="TxtNextSteps" TextWrapping="Wrap" Text="• Access your application at the configured URL&#10;• Configure your application settings if needed&#10;• Check IIS Manager for site details"/>
                            </StackPanel>
                        </Border>

                        <Button x:Name="BtnOpenSite"
                               Content="Open Site in Browser"
                               Click="BtnOpenSite_Click"
                               Margin="0,20,0,0"
                               IsEnabled="False"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Navigation Buttons -->
        <Border Grid.Row="2" BorderBrush="#DDD" BorderThickness="0,1,0,0" Background="#F5F5F5">
            <StackPanel Orientation="Horizontal"
                       HorizontalAlignment="Right"
                       Margin="20,15">
                <Button x:Name="BtnPrevious"
                       Content="← Previous"
                       Click="BtnPrevious_Click"
                       IsEnabled="False"/>
                <Button x:Name="BtnNext"
                       Content="Next →"
                       Click="BtnNext_Click"/>
                <Button x:Name="BtnInstall"
                       Content="Install"
                       Click="BtnInstall_Click"
                       Visibility="Collapsed"
                       Background="#4CAF50"
                       Foreground="White"
                       FontWeight="Bold"/>
                <Button x:Name="BtnFinish"
                       Content="Finish"
                       Click="BtnFinish_Click"
                       Visibility="Collapsed"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
